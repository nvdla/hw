//Feature
mem_init(pri_mem, 0x80000000, 0xc0000, ALL_ZERO);
mem_load(pri_mem, 0x80000000, "img_51x96x4_1x10x4x32_B8G8R8A8_int8_0_dt.dat");
//Weight
mem_init(pri_mem, 0x90005200, 0x9100, ALL_ZERO);
mem_load(pri_mem, 0x90005200, "img_51x96x4_1x10x4x32_B8G8R8A8_int8_0_wt.dat");
//Dest
mem_init(pri_mem, 0xa00000e0, 0x16000, ALL_ZERO);
//Disable CDMA DATA_DONE and WEIGHT_DONE interrupts
reg_write(NVDLA_GLB.S_INTR_MASK_0, 0x3f03fc);
reg_write(NVDLA_GLB.S_INTR_STATUS_0, 0x0);
reg_write(NVDLA_SDP.S_POINTER_0, 0x0);
reg_write(NVDLA_SDP.D_DATA_CUBE_WIDTH_0, 0xb);
reg_write(NVDLA_SDP.D_PERF_OUT_SATURATION_0, 0x0);
reg_write(NVDLA_SDP.D_DST_BASE_ADDR_HIGH_0, 0x0);
reg_write(NVDLA_SDP.D_DP_EW_ALU_SRC_VALUE_0, 0xbc470fb3);
reg_write(NVDLA_SDP.D_PERF_LUT_UFLOW_0, 0x0);
reg_write(NVDLA_SDP.D_DATA_FORMAT_0, 0x0);
reg_write(NVDLA_SDP.D_PERF_ENABLE_0, 0x1);
reg_write(NVDLA_SDP.D_STATUS_NAN_INPUT_NUM_0, 0x0);
reg_write(NVDLA_SDP.D_DATA_CUBE_CHANNEL_0, 0x1f);
reg_write(NVDLA_SDP.D_DP_BS_ALU_CFG_0, 0x1a01);
reg_write(NVDLA_SDP.D_PERF_LUT_OFLOW_0, 0x0);
reg_write(NVDLA_SDP.D_PERF_WDMA_WRITE_STALL_0, 0x0);
reg_write(NVDLA_SDP.D_STATUS_0, 0x0);
reg_write(NVDLA_SDP.D_DP_EW_ALU_CVT_TRUNCATE_VALUE_0, 0x322);
reg_write(NVDLA_SDP.D_DST_BASE_ADDR_LOW_0, 0xa00000e0);
reg_write(NVDLA_SDP.D_DP_BN_ALU_SRC_VALUE_0, 0x50d5f3a7);
reg_write(NVDLA_SDP.D_DST_LINE_STRIDE_0, 0x200);
reg_write(NVDLA_SDP.D_DST_BATCH_STRIDE_0, 0x9a128440);
reg_write(NVDLA_SDP.D_STATUS_NAN_OUTPUT_NUM_0, 0x0);
reg_write(NVDLA_SDP.D_CVT_SHIFT_0, 0x0);
reg_write(NVDLA_SDP.D_DP_EW_ALU_CVT_SCALE_VALUE_0, 0x2d41);
reg_write(NVDLA_SDP.D_DP_BS_MUL_SRC_VALUE_0, 0x7ff1);
reg_write(NVDLA_SDP.D_DP_EW_MUL_CFG_0, 0x2);
reg_write(NVDLA_SDP.D_DP_EW_TRUNCATE_VALUE_0, 0x20);
reg_write(NVDLA_SDP.D_DP_BN_MUL_SRC_VALUE_0, 0x5b60a1f9);
reg_write(NVDLA_SDP.D_DP_EW_ALU_CFG_0, 0x1);
reg_write(NVDLA_SDP.D_CVT_SCALE_0, 0x1);
reg_write(NVDLA_SDP.D_DP_BN_MUL_CFG_0, 0x2401);
reg_write(NVDLA_SDP.S_LUT_LE_START_0, 0xb791ca6c);
reg_write(NVDLA_SDP.D_DP_EW_MUL_CVT_OFFSET_VALUE_0, 0x415179e2);
reg_write(NVDLA_SDP.D_DP_BN_ALU_CFG_0, 0x7101);
reg_write(NVDLA_SDP.D_DP_EW_MUL_CVT_SCALE_VALUE_0, 0x1c26);
reg_write(NVDLA_SDP.D_DST_SURFACE_STRIDE_0, 0x5800);
reg_write(NVDLA_SDP.D_DATA_CUBE_HEIGHT_0, 0x2b);
reg_write(NVDLA_SDP.D_DP_BS_MUL_CFG_0, 0x3300);
reg_write(NVDLA_SDP.D_DP_BS_CFG_0, 0x7);
reg_write(NVDLA_SDP.D_DP_EW_MUL_CVT_TRUNCATE_VALUE_0, 0x20d);
reg_write(NVDLA_SDP.D_DP_BS_ALU_SRC_VALUE_0, 0x69f0280c);
reg_write(NVDLA_SDP.D_PERF_LUT_LO_HIT_0, 0x0);
reg_write(NVDLA_SDP.D_STATUS_INF_INPUT_NUM_0, 0x0);
reg_write(NVDLA_SDP.D_CVT_OFFSET_0, 0x0);
reg_write(NVDLA_SDP.S_LUT_LE_END_0, 0xb791ca6c);
reg_write(NVDLA_SDP.D_DP_EW_ALU_CVT_OFFSET_VALUE_0, 0x4dab6d87);
reg_write(NVDLA_SDP.D_FEATURE_MODE_CFG_0, 0x9);
reg_write(NVDLA_SDP.D_DST_DMA_CFG_0, 0x1);
reg_write(NVDLA_SDP.D_DP_BN_CFG_0, 0x73);
reg_write(NVDLA_SDP.D_PERF_LUT_HYBRID_0, 0x0);
reg_write(NVDLA_SDP.D_DP_EW_CFG_0, 0x7b);
reg_write(NVDLA_SDP.D_PERF_LUT_LE_HIT_0, 0x0);
reg_write(NVDLA_SDP.D_DP_EW_MUL_SRC_VALUE_0, 0xc774);
reg_write(NVDLA_SDP.S_STATUS_0, 0x0);
reg_write(NVDLA_CDMA.S_POINTER_0, 0x0);
reg_write(NVDLA_CDMA.D_ZERO_PADDING_VALUE_0, 0x91);
reg_write(NVDLA_CDMA.D_ENTRY_PER_SLICE_0, 0x6);
reg_write(NVDLA_CDMA.D_WMB_ADDR_HIGH_0, 0x3e);
reg_write(NVDLA_CDMA.D_WEIGHT_SIZE_0_0, 0x487);
reg_write(NVDLA_CDMA.S_CBUF_FLUSH_STATUS_0, 0x0);
reg_write(NVDLA_CDMA.D_MEAN_FORMAT_0, 0x1);
reg_write(NVDLA_CDMA.D_SURF_STRIDE_0, 0xc0000);
reg_write(NVDLA_CDMA.D_DATAIN_SIZE_1_0, 0x3);
reg_write(NVDLA_CDMA.D_PERF_DAT_READ_LATENCY_0, 0x0);
reg_write(NVDLA_CDMA.D_CONV_STRIDE_0, 0x10001);
reg_write(NVDLA_CDMA.D_DAIN_RAM_TYPE_0, 0x1);
reg_write(NVDLA_CDMA.D_INF_INPUT_WEIGHT_NUM_0, 0x0);
reg_write(NVDLA_CDMA.D_NAN_FLUSH_TO_ZERO_0, 0x1);
reg_write(NVDLA_CDMA.D_WMB_ADDR_LOW_0, 0x79ffb060);
reg_write(NVDLA_CDMA.D_WEIGHT_BYTES_0, 0x9100);
reg_write(NVDLA_CDMA.D_WEIGHT_RAM_TYPE_0, 0x1);
reg_write(NVDLA_CDMA.D_WEIGHT_FORMAT_0, 0x0);
reg_write(NVDLA_CDMA.S_STATUS_0, 0x0);
reg_write(NVDLA_CDMA.D_PERF_WT_READ_STALL_0, 0x0);
reg_write(NVDLA_CDMA.D_FETCH_GRAIN_0, 0x0);
reg_write(NVDLA_CDMA.D_DAIN_MAP_0, 0x0);
reg_write(NVDLA_CDMA.D_BATCH_NUMBER_0, 0x0);
reg_write(NVDLA_CDMA.S_ARBITER_0, 0x10001);
reg_write(NVDLA_CDMA.D_DATAIN_SIZE_EXT_0_0, 0x5f0032);
reg_write(NVDLA_CDMA.D_BATCH_STRIDE_0, 0xe67ba680);
reg_write(NVDLA_CDMA.D_PERF_DAT_READ_STALL_0, 0x0);
reg_write(NVDLA_CDMA.D_DAIN_ADDR_LOW_0_0, 0x80000000);
reg_write(NVDLA_CDMA.D_DATAIN_FORMAT_0, 0xe01);
reg_write(NVDLA_CDMA.D_INF_INPUT_DATA_NUM_0, 0x0);
reg_write(NVDLA_CDMA.D_WMB_BYTES_0, 0x2a11b00);
reg_write(NVDLA_CDMA.D_CVT_CFG_0, 0x21);
reg_write(NVDLA_CDMA.D_PERF_ENABLE_0, 0x0);
reg_write(NVDLA_CDMA.D_WGS_ADDR_LOW_0, 0xf7429c0);
reg_write(NVDLA_CDMA.D_NAN_INPUT_DATA_NUM_0, 0x0);
reg_write(NVDLA_CDMA.D_DAIN_ADDR_HIGH_0_0, 0x0);
reg_write(NVDLA_CDMA.D_ZERO_PADDING_0, 0x0);
reg_write(NVDLA_CDMA.D_MEAN_GLOBAL_1_0, 0xeac51712);
reg_write(NVDLA_CDMA.D_WEIGHT_SIZE_1_0, 0x1f);
reg_write(NVDLA_CDMA.D_LINE_STRIDE_0, 0x2000);
reg_write(NVDLA_CDMA.D_CVT_SCALE_0, 0x4);
reg_write(NVDLA_CDMA.D_DAIN_ADDR_LOW_1_0, 0x3d20f300);
reg_write(NVDLA_CDMA.D_BANK_0, 0x190005);
reg_write(NVDLA_CDMA.D_NAN_INPUT_WEIGHT_NUM_0, 0x0);
reg_write(NVDLA_CDMA.D_DATAIN_SIZE_0_0, 0x5f0032);
reg_write(NVDLA_CDMA.D_PIXEL_OFFSET_0, 0x0);
reg_write(NVDLA_CDMA.D_MISC_CFG_0, 0x0);
reg_write(NVDLA_CDMA.D_CVT_OFFSET_0, 0xa);
reg_write(NVDLA_CDMA.D_MEAN_GLOBAL_0_0, 0x8735e51d);
reg_write(NVDLA_CDMA.D_WGS_ADDR_HIGH_0, 0x75);
reg_write(NVDLA_CDMA.D_WEIGHT_ADDR_LOW_0, 0x90005200);
reg_write(NVDLA_CDMA.D_DAIN_ADDR_HIGH_1_0, 0x0);
reg_write(NVDLA_CDMA.D_WEIGHT_ADDR_HIGH_0, 0x0);
reg_write(NVDLA_CDMA.D_PERF_WT_READ_LATENCY_0, 0x0);
reg_write(NVDLA_CDMA.D_LINE_UV_STRIDE_0, 0xf1807fc0);
reg_write(NVDLA_CDMA.D_CYA_0, 0x631a686d);
reg_write(NVDLA_CSC.S_POINTER_0, 0x0);
reg_write(NVDLA_CSC.D_WEIGHT_BYTES_0, 0x9100);
reg_write(NVDLA_CSC.D_ZERO_PADDING_0, 0x0);
reg_write(NVDLA_CSC.S_STATUS_0, 0x0);
reg_write(NVDLA_CSC.D_WEIGHT_SIZE_EXT_0_0, 0x90000);
reg_write(NVDLA_CSC.D_DATAIN_FORMAT_0, 0x1);
reg_write(NVDLA_CSC.D_ENTRY_PER_SLICE_0, 0x6);
reg_write(NVDLA_CSC.D_BATCH_NUMBER_0, 0x0);
reg_write(NVDLA_CSC.D_RELEASE_0, 0x1);
reg_write(NVDLA_CSC.D_BANK_0, 0x190005);
reg_write(NVDLA_CSC.D_CONV_STRIDE_EXT_0, 0x10001);
reg_write(NVDLA_CSC.D_PRA_CFG_0, 0x0);
reg_write(NVDLA_CSC.D_DATAIN_SIZE_EXT_0_0, 0x5f0032);
reg_write(NVDLA_CSC.D_ZERO_PADDING_VALUE_0, 0x91);
reg_write(NVDLA_CSC.D_WMB_BYTES_0, 0x2a11b00);
reg_write(NVDLA_CSC.D_DATAOUT_SIZE_0_0, 0x2b000b);
reg_write(NVDLA_CSC.D_WEIGHT_SIZE_EXT_1_0, 0x1f0073);
reg_write(NVDLA_CSC.D_MISC_CFG_0, 0x0);
reg_write(NVDLA_CSC.D_WEIGHT_FORMAT_0, 0x0);
reg_write(NVDLA_CSC.D_POST_Y_EXTENSION_0, 0x0);
reg_write(NVDLA_CSC.D_DILATION_EXT_0, 0x0);
reg_write(NVDLA_CSC.D_CYA_0, 0x631a686d);
reg_write(NVDLA_CSC.D_ATOMICS_0, 0x20f);
reg_write(NVDLA_CSC.D_DATAIN_SIZE_EXT_1_0, 0x3);
reg_write(NVDLA_CSC.D_DATAOUT_SIZE_1_0, 0x1f);
reg_write(NVDLA_CMAC_A.S_POINTER_0, 0x0);
reg_write(NVDLA_CMAC_A.D_MISC_CFG_0, 0x0);
reg_write(NVDLA_CMAC_A.S_STATUS_0, 0x0);
reg_write(NVDLA_CMAC_B.S_POINTER_0, 0x0);
reg_write(NVDLA_CMAC_B.D_MISC_CFG_0, 0x0);
reg_write(NVDLA_CMAC_B.S_STATUS_0, 0x0);
reg_write(NVDLA_CACC.S_POINTER_0, 0x0);
reg_write(NVDLA_CACC.D_DATAOUT_SIZE_0_0, 0x2b000b);
reg_write(NVDLA_CACC.D_DATAOUT_ADDR_0, 0x51f1f040);
reg_write(NVDLA_CACC.S_STATUS_0, 0x0);
reg_write(NVDLA_CACC.D_CYA_0, 0x631a686d);
reg_write(NVDLA_CACC.D_SURF_STRIDE_0, 0x5800);
reg_write(NVDLA_CACC.D_CLIP_CFG_0, 0x3);
reg_write(NVDLA_CACC.D_BATCH_NUMBER_0, 0x0);
reg_write(NVDLA_CACC.D_MISC_CFG_0, 0x0);
reg_write(NVDLA_CACC.D_DATAOUT_MAP_0, 0x0);
reg_write(NVDLA_CACC.D_DATAOUT_SIZE_1_0, 0x1f);
reg_write(NVDLA_CACC.D_OUT_SATURATION_0, 0x0);
reg_write(NVDLA_CACC.D_LINE_STRIDE_0, 0x200);
poll_reg_equal(NVDLA_CDMA.S_CBUF_FLUSH_STATUS_0,0x1);
reg_write(NVDLA_SDP.D_OP_ENABLE_0, 0x1);
reg_write(NVDLA_CACC.D_OP_ENABLE_0, 0x1);
reg_write(NVDLA_CMAC_A.D_OP_ENABLE_0, 0x1);
reg_write(NVDLA_CMAC_B.D_OP_ENABLE_0, 0x1);
reg_write(NVDLA_CSC.D_OP_ENABLE_0, 0x1);
reg_write(NVDLA_CDMA.D_OP_ENABLE_0, 0x1);
intr_notify(SDP_0, sync_id_0);
check_crc(sync_id_0, 1, 0xa00000e0, 0x16000, 0x508b6954);
